<%- include('partials/header') %>
<%- include('partials/editors_nav') %>
<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
  <h2 class="mb-0">Timeline Levels (<%= site %>) <a href="/pandas-way-alt5" class="ms-2 small text-decoration-none" target="_blank"><i class="bi bi-box-arrow-up-right"></i></a></h2>
    <form class="d-flex align-items-end gap-2" method="post" action="/editors/timeline-editor/site-config">
      <% if (typeof csrfToken !== 'undefined' && csrfToken) { %>
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
      <% } %>
      <input type="hidden" name="site_key" value="<%= site %>">
      <div>
        <label class="form-label mb-0 small">Level Count</label>
  <input type="number" min="1" max="12" name="level_count" value="<%= config.level_count %>" class="form-control form-control-sm w-90">
      </div>
      <div>
        <label class="form-label mb-0 small">Design</label>
        <select name="design_theme" class="form-select form-select-sm">
          <option value="glass" <%= config.design_theme==='glass'? 'selected':'' %>>Glass</option>
          <option value="classic" <%= config.design_theme==='classic'? 'selected':'' %>>Classic</option>
          <option value="minimal" <%= config.design_theme==='minimal'? 'selected':'' %>>Minimal</option>
        </select>
      </div>
      <button class="btn btn-sm btn-primary">Speichern</button>
    </form>
  </div>
  <p class="text-muted small mb-4">Wähle ein Level zum Bearbeiten oder passe Anzahl & Design an.</p>
  <div class="row g-4">
    <% levels.forEach(function(l){ %>
      <div class="col-md-4 col-lg-3">
        <div class="card h-100 shadow-sm border-0 level-card theme-<%= config.design_theme %>">
          <div class="card-body d-flex flex-column">
            <div class="d-flex justify-content-between align-items-start mb-2">
              <strong>Level <%= l.level_index %></strong>
              <span class="badge bg-secondary"><%= l.entry_count %> Cards</span>
            </div>
            <div class="small text-truncate mb-2"><i class="bi bi-justify"></i> <%- l.title %></div>
            <% if(l.image_path){ %>
              <img src="<%= l.image_path %>" class="img-fluid rounded mb-2" alt="Level Bild">
            <% } %>
            <a href="/editors/timeline-editor?site=<%= encodeURIComponent(site) %>&level=<%= l.level_index %>" class="btn btn-sm btn-outline-primary mt-auto">Öffnen</a>
          </div>
        </div>
      </div>
    <% }); %>
  </div>
</div>
<style>
.level-card.theme-glass{background:rgba(255,255,255,0.15);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,0.3);}
.level-card.theme-classic{background:#fff;border:1px solid #ddd;}
.level-card.theme-minimal{background:#111;border:1px solid #222;color:#eee;}
</style>
<%- include('partials/footer') %>
