<%- include('partials/header',{title:title}) %>
<h1>Benutzer bearbeiten</h1>
<% if(error){ %><div class="alert alert-danger"><%= error %></div><% } %>
<div class="card mb-3">
  <div class="card-body">
    <dl class="row mb-0">
      <dt class="col-sm-3">ID</dt><dd class="col-sm-9"><%= user.id %></dd>
      <dt class="col-sm-3">Username</dt><dd class="col-sm-9"><%= user.username %></dd>
      <dt class="col-sm-3">Aktuelle Rolle</dt><dd class="col-sm-9"><span class="badge bg-<%= user.role==='admin'?'danger':(user.role==='editor'?'primary':'secondary') %>"><%= user.role %></span></dd>
      <dt class="col-sm-3">Status</dt><dd class="col-sm-9"><%= user.is_deleted? 'gelöscht' : 'aktiv' %></dd>
    </dl>
  </div>
</div>
<form method="post" class="mb-4">
  <div class="mb-2">
    <label class="form-label">Neue Rolle</label>
    <select name="role" class="form-select">
      <option value="">(unverändert)</option>
      <option value="editor">Editor</option>
      <option value="admin">Admin</option>
      <option value="viewer">Viewer (public)</option>
    </select>
  </div>
  <div class="mb-2">
    <label class="form-label">Neues Passwort</label>
    <input name="password" type="password" class="form-control" placeholder="(leer lassen für unverändert)">
  </div>
  <button class="btn btn-primary">Speichern</button>
  <a class="btn btn-secondary" href="/admin/users">Zurück</a>
</form>
<form method="post" onsubmit="return confirm('Benutzer wirklich löschen (soft)?');">
  <input type="hidden" name="action" value="delete">
  <button class="btn btn-outline-danger">Soft Delete</button>
</form>
<% if(user.is_deleted){ %>
<form method="post" class="mt-2" onsubmit="return confirm('Wiederherstellen?');">
  <input type="hidden" name="action" value="restore">
  <button class="btn btn-outline-success">Restore</button>
</form>
<form method="post" class="mt-2" onsubmit="return confirm('Hard Delete? Dies ist endgültig!');">
  <input type="hidden" name="action" value="hard_delete">
  <button class="btn btn-danger">Hard Delete (final)</button>
</form>
<% } %>
<%- include('partials/footer') %>
